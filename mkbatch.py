#this program creates 20 batch files which contain a list of file names which are in each batch.
#the batches have approximately the same distribution of classes as the total data set

import pandas as pd
import numpy as np

Y = pd.read_csv("trainLabels.csv").to_numpy()


class1 = []
class2 = []
class3 = []
class4 = []
class5 = []
class6 = []
class7 = []
class8 = []
class9 = []


for y in Y:
	if int(y[1]) == 1:
		class1.append(y[0])
	if int(y[1]) == 2:
		class2.append(y[0])
	if int(y[1]) == 3:
		class3.append(y[0])
	if int(y[1]) == 4:
		class4.append(y[0])
	if int(y[1]) == 5:
		class5.append(y[0])
	if int(y[1]) == 6:
		class6.append(y[0])
	if int(y[1]) == 7:
		class7.append(y[0])
	if int(y[1]) == 8:
		class8.append(y[0])
	if int(y[1]) == 9:
		class9.append(y[0])

for k in range(0,20):
	fp = open("batches/batch"+str(k+1),"w")
	for i in class1[(k*77):(k+1)*77]:
		fp.write(i+",1\n")
	for i in class2[(k*123):(k+1)*123]:
		fp.write(i+",2\n")
	for i in class3[(k*147):(k+1)*147]:
		fp.write(i+",3\n")
	for i in class4[(k*23):(k+1)*23]:
		fp.write(i+",4\n")
	for i in class5[(k*2):(k+1)*2]:
		fp.write(i+",5\n")
	for i in class6[(k*37):(k+1)*37]:
		fp.write(i+",6\n")
	for i in class7[(k*19):(k+1)*19]:
		fp.write(i+",7\n")
	for i in class8[(k*61):(k+1)*61]:
		fp.write(i+",8\n")
	for i in class9[(k*50):(k+1)*50]:
		fp.write(i+",9\n")

